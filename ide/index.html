<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8"></meta>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"></meta>
    <link rel="shortcut icon" href="static/images/favicon.ico" />
    <link rel="icon" type="image/png" href="static/images/favicon.png" />
    <link rel="stylesheet" type="text/css" href="static/css/reset.css"></link>
    <link rel="stylesheet" type="text/css" href="static/css/fonts.css"></link>
    <title>Drakon Ide</title>
  </head>
  <body style="overflow:hidden;">

    <canvas id="exportCanvas" style="display:none;"></canvas>

    <div id="wide" style="display:none;">
    </div>

    <div id="central" style="display: none;"></div>

    <div id="dialog"></div>

    <div id="tooltip" style="display: none;">
    </div>

    <div id="popup" style="display: none; cursor:pointer;">
    	<table>
    		<tr>
    			<td id="popup_text" style="padding:10px;"></td>
    			<td id="popup_close" style="padding: 10px;"><%=trans("Close")%></td>
    		</tr>
    	</table>
    </div>


    <div id="working" class="full_screen abs" style="text-align:center; display:none; zIndex:80;">
    	<div style="display:inline-block; background:white; padding:10px; margin-top:45vh; border: solid 1px grey;"><%=trans("working")%></div>
    </div>

    <div id="panic" class="full_screen" style="display:none; background:white;">
    	<div style="width:300px; position:absolute; left:calc(50% - 150px); top:calc(50vh - 97px); text-align:center;">
    		<div id="panic_message" style="margin-bottom:30px; text-align:center; padding:5px;"></div>

    		<div style="display:inline-block;">
    			<div class="panic_button" onclick="window.location.reload()" ><%=trans("dia_reload")%></div>
    			<div class="panic_button" onclick="window.history.back()" ><%=trans("dia_back")%></div>
    			<a href="/ide/dashboard" class="no_under" id="panicDashboard" style="display:none;"><div class="panic_button" style="background:coral;"><%=trans("dia_home")%></div></a>
    			<a href="/" class="no_under" id="panicHome" style="display:none;"><div class="panic_button" style="background:coral;"><%=trans("dia_home")%></div></a>
    		</div>

    	</div>
    </div>


    <script src="static/libs/mousetrap.js"></script>
    <script src="static/libs/fontfaceobserver.js"></script>

    <script src="static/HtmlUtils.js"></script>
    <script src="static/Canvas.js"></script>
    <script src="static/Logon.js"></script>
    <script src="static/EditorCtrl.js"></script>
    <script src="static/Editor.js"></script>
    <script src="static/DraWidgets.js"></script>
    <script src="static/Popup.js"></script>
    <script src="static/Items.js"></script>
    <script src="static/ToolTip.js"></script>
    <script src="static/TabGen4.js"></script>
    <script src="static/Drakon.js"></script>
    <script src="static/ViewWidget.js"></script>
    <script src="static/Multitouch.js"></script>
    <script src="static/CallTrace.js"></script>
    <script src="static/Config.js"></script>
    <script src="static/DTools.js"></script>
    <script src="static/Behaviour.js"></script>
    <script src="static/Nav.js"></script>
    <script src="static/Utils.js"></script>
    <script src="static/PhysicalGraph.js"></script>
    <script src="static/Ide3.js"></script>
    <script src="static/Ide3Logic.js"></script>

    <script>
      function translate(text) {
  	      /*if (text in strings) {
  		        return strings[text]
  	      }*/
  	      return text
      }

      var gUserId = 'id'
      var onPremises = false
      var pagePanic = function(text) {
      	window.onbeforeunload = null
      	HtmlUtils.hide("loading")
      	HtmlUtils.hide("wide")
      	HtmlUtils.hide("working")
      	HtmlUtils.hide("popup")
      	if (gUserId) {
      		HtmlUtils.show("panicDashboard", "block")
      	} else {
      		HtmlUtils.show("panicHome", "block")
      	}
      	HtmlUtils.show("panic", "inline-block")
      	document.getElementById("panic").style.zIndex = 1000
      	HtmlUtils.setText("panic_message", text)
      }

      window.onerror = pagePanic

      if (HtmlUtils.isBrowserSupported()) {
          ide = new Ide3(window, document, translate, gUserId, pagePanic)
          logic = new Ide3Logic(gUserId, ide, translate)
	        ide.logic = logic
          ide.init()
      } else {
        HtmlUtils.show("panic", "block")
        var message = translate("ERR_BROWSER_NOT_SUPPORTED")
        HtmlUtils.setText("panic_message", message)
      }

    </script>

  </body>
</html>
